{% load i18n %}
{% if categories %}

<div class="d-flex align-items-center justify-content-between mb-4">
    <h2 class="mb-0 fw-bold">{% trans "Season Collection" %}</h2>
    <a href="{% url 'shop:category_detail' slug='all' %}" class="btn btn-outline-dark fw-semibold">
        {% trans "View all categories" %}<i class="fas fa-gem me-2"></i> 
    </a>
</div>

<div class="swiper category-swiper-unique mb-0"> {# Changed mb-5 to mb-0 here #}
    <div class="swiper-wrapper">
        {% for cat in categories %}
        <div class="swiper-slide text-center">
            <div class="season-category-card position-relative mx-auto">
                {# Removed d-flex justify-content-center from category-circle as it's not needed for img #}
                <div class="category-circle position-relative mb-3">
                    {% if cat.image %}
                        <img src="{{ cat.image.url }}" class="rounded-circle w-100 h-100 object-fit-cover" alt="{{ cat.name }}">
                    {% else %}
                        {# Fallback image for categories without an image #}
                        <img src="https://placehold.co/120x120/e0e0e0/555555?text={{ cat.name|slice:":1" }}" class="rounded-circle w-100 h-100 object-fit-cover" alt="{{ cat.name }}">
                    {% endif %}
                    <a href="{% url 'shop:category_detail' slug=cat.slug %}" class="stretched-link">
                        {# The arrow-icon div is completely removed from HTML as it's not in the image #}
                    </a>
                </div>
                {# text-center class for category-label is correctly applied #}
                <div class="category-label fw-semibold text-center">{{ cat.name }}</div>
            </div>
        </div>
        {% endfor %}
    </div>

</div> {# This closing div was misplaced, now it correctly closes .swiper-unique #}

<style>
/* Custom styles to match the provided image */
.season-category-card {
    width: 150px; /* Slightly wider to match the image proportions */
    margin: 0 auto;
}

.category-circle {
    width: 120px;
    height: 120px;
    overflow: hidden;
    border-radius: 50%;
    position: relative;
    /* Removed box-shadow to match the image */
}

.category-circle img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: transform 0.3s ease;
}

.category-circle:hover img {
    transform: scale(1.05);
}

/* Hidden in the image, so we'll ensure the arrow-icon is not displayed */
.arrow-icon {
    display: none; /* This ensures if it somehow renders, it's hidden */
}

/* Responsive text sizes using fluid typography or media queries */
.category-label {
    /* Responsive font size */
    font-size: clamp(1rem, 4vw, 1.4rem); /* Min 1rem, preferred 4vw, Max 1.4rem */
    margin-top: 0.5rem; /* Adjust spacing */
    margin-bottom: 0.2rem;
    color: #333; /* Darker text for labels */
    /* text-align is correctly handled by Bootstrap's text-center class on the div */
}

.category-count {
    /* Responsive font size */
    font-size: clamp(0.75rem, 2.5vw, 0.875rem); /* Min 0.75rem, preferred 2.5vw, Max 0.875rem */
    color: #6c757d; /* Standard muted color */
}

/* Swiper specific overrides for navigation buttons */
.category-swiper-unique .swiper-button-next,
.category-swiper-unique .swiper-button-prev {
    display: none !important; /* Hides any default Swiper navigation arrows */
}

/* If Swiper's default pseudo-elements for arrows are active, this removes them */
.swiper-button-next:after,
.swiper-button-prev:after {
    content: '' !important;
}

/* Adjust the view all categories link arrow */
.btn.btn-outline-dark i { /* Targeting the icon inside the specific button */
    font-size: 0.75em; /* Smaller arrow to match image */
    vertical-align: middle; /* Align with text */
    margin-left: 0.25rem; /* Add a bit of space */
}

/* Adding basic transition for the Bootstrap button if not already defined by Bootstrap itself */
.btn {
    transition: all 0.2s ease-in-out;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function () {
    new Swiper('.category-swiper-unique', {
        loop: false,
        slidesPerView: 2,
        spaceBetween: 10,
        // Navigation object is removed as the buttons are not intended to be present
        breakpoints: {
            576: { slidesPerView: 3, spaceBetween: 15 },
            768: { slidesPerView: 4, spaceBetween: 15 },
            992: { slidesPerView: 6, spaceBetween: 20 },
            1200: { slidesPerView: 7, spaceBetween: 20 },
            1400: { slidesPerView: 8, spaceBetween: 20 },
        },
    });
});
</script>
{% endif %}