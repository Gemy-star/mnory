{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block css %}
<!-- Home page specific styles -->
{% endblock %}

{% block content %}
<!-- Hero Slider -->
{% include 'shop/partials/hero_slider.html' %}

<!-- Category Tabs with Products -->
{% include 'shop/partials/_categories.html' with cat_name="body" categories=categories initial_category_products=initial_category_products currency=currency %}

<!-- Featured Products Section -->
{% if config.ENABLE_FEATURED_FLAG %}
<section class="product-section featured-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="50">
            <h2 class="section-title-tabs">
                <span class="material-icons">star</span>
                {% trans "Featured Products" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Hand-picked premium products just for you" %}</p>
        </div>

    <!-- Products Container (category-style) -->
    <div class="category-products-container" data-aos="fade-up" data-aos-delay="150">
            <!-- Loading / Empty states and header are handled here like _categories -->
            <div class="category-products-container aos-init aos-animate" data-aos="fade-up" data-aos-delay="150">
                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="featuredProductsSwiper" data-aos="fade-up" data-aos-delay="200">
                    <div class="swiper featured-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in featured_products %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="featured_products" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">star_border</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any featured products at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev featured-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next featured-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- New Arrivals Section -->
{% if config.ENABLE_NEW_ARRIVAL_FLAG %}
<section class="product-section newarrivals-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="100">
            <h2 class="section-title-tabs">
                <span class="material-icons">new_releases</span>
                {% trans "New Arrivals" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Fresh styles and latest trends" %}</p>
        </div>

        <!-- Products Container (category-style) -->
        <div class="category-products-container" data-aos="fade-up" data-aos-delay="200">
            <div class="category-products-container aos-init aos-animate" data-aos="fade-up" data-aos-delay="200">
                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="newarrivalsProductsSwiper" data-aos="fade-up" data-aos-delay="220">
                    <div class="swiper newarrivals-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in new_arrivals %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="new_arrivals" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">new_releases</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any new arrivals at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev newarrivals-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next newarrivals-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Best Sellers Section -->
{% if config.ENABLE_BEST_SELLER_FLAG %}
<section class="product-section bestseller-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="150">
            <h2 class="section-title-tabs">
                <span class="material-icons">trending_up</span>
                {% trans "Best Sellers" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Most popular products loved by customers" %}</p>
        </div>

        <!-- Products Container (category-style) -->
        <div class="category-products-container" data-aos="fade-up" data-aos-delay="250">

                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="bestsellerProductsSwiper" data-aos="fade-up" data-aos-delay="270">
                    <div class="swiper bestseller-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in best_sellers %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="best_sellers" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">trending_up</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any best sellers at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev bestseller-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next bestseller-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- On Sale Section -->
{% if config.ENABLE_SALE_FLAG %}
<section class="product-section sale-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="200">
            <h2 class="section-title-tabs sale-title">
                <span class="material-icons sale-icon">local_offer</span>
                {% trans "On Sale!" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Don't miss these amazing deals and discounts" %}</p>
        </div>

        <!-- Products Container (category-style) -->
        <div class="category-products-container" data-aos="fade-up" data-aos-delay="300">
                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="onsaleProductsSwiper" data-aos="fade-up" data-aos-delay="320">
                    <div class="swiper onsale-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in sale_products %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="sale_products" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">local_offer</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any sale products at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev onsale-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next onsale-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Home Categories -->
<section class="product-section home-categories-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="250">
            <h2 class="section-title-tabs">
                <span class="material-icons">category</span>
                {% trans "Shop Categories" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Explore our diverse product categories" %}</p>
        </div>
            {% include 'shop/partials/_home_categories.html' %}

    </div>
</section>

<!-- Freelance Categories -->
<section class="product-section freelance-categories-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="300">
            <h2 class="section-title-tabs">
                <span class="material-icons">work</span>
                {% trans "Freelance Services" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Professional services by skilled freelancers" %}</p>
        </div>
            {% include 'freelance/partials/_home_categories.html' %}
    </div>
</section>

<!-- Top Jobs Section -->
<section class="freelancing-section top-jobs-section" style="padding: 5rem 0; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); position: relative; overflow: hidden;">
    <!-- Animated Background Elements -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
        <div style="position: absolute; width: 300px; height: 300px; background: rgba(255,255,255,0.05); border-radius: 50%; top: -100px; left: -50px;"></div>
        <div style="position: absolute; width: 200px; height: 200px; background: rgba(255,255,255,0.05); border-radius: 50%; bottom: -80px; right: 10%;"></div>
    </div>

    <div class="container" style="position: relative; z-index: 1;">
        <!-- Section Header -->
        <div class="section-header-tabs text-center mb-5" data-aos="fade-down">
            <div class="d-inline-flex align-items-center justify-content-center mb-3"
                 style="width: 70px; height: 70px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border-radius: 50%; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <span class="material-icons" style="font-size: 36px; color: white;">work</span>
            </div>
            <h2 class="section-title-tabs mb-3" style="color: white; font-size: 2.5rem; font-weight: 700;">
                {% trans "Featured Jobs" %}
            </h2>
            <p class="section-subtitle-tabs" style="color: rgba(255,255,255,0.95); font-size: 1.1rem; max-width: 600px; margin: 0 auto;">
                {% trans "Discover exciting opportunities from top companies" %}
            </p>
        </div>

        {% include 'freelance/partials/_top_jobs.html' with top_jobs=top_jobs %}

        <div class="text-center mt-5" data-aos="fade-up" data-aos-delay="400">
            <a href="{% url 'project_list' %}" class="btn btn-light btn-lg px-5 py-3"
               style="border-radius: 50px; font-weight: 600; box-shadow: 0 8px 24px rgba(0,0,0,0.2); transition: all 0.3s;">
                <i class="fas fa-briefcase me-2"></i>{% trans "Explore All Jobs" %}
            </a>
        </div>
    </div>
</section>

<!-- Top Freelancers Section -->
<section class="freelancing-section top-freelancers-section" style="padding: 5rem 0; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); position: relative; overflow: hidden;">
    <!-- Animated Background Elements -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
        <div style="position: absolute; width: 250px; height: 250px; background: rgba(255,255,255,0.08); border-radius: 50%; top: 10%; right: 5%;"></div>
        <div style="position: absolute; width: 180px; height: 180px; background: rgba(255,255,255,0.08); border-radius: 50%; bottom: 15%; left: 8%;"></div>
    </div>

    <div class="container" style="position: relative; z-index: 1;">
        <!-- Section Header -->
        <div class="section-header-tabs text-center mb-5" data-aos="fade-down">
            <div class="d-inline-flex align-items-center justify-content-center mb-3"
                 style="width: 70px; height: 70px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border-radius: 50%; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <span class="material-icons" style="font-size: 36px; color: white;">people</span>
            </div>
            <h2 class="section-title-tabs mb-3" style="color: white; font-size: 2.5rem; font-weight: 700;">
                {% trans "Top Freelancers" %}
            </h2>
            <p class="section-subtitle-tabs" style="color: rgba(255,255,255,0.95); font-size: 1.1rem; max-width: 600px; margin: 0 auto;">
                {% trans "Connect with skilled professionals ready to bring your projects to life" %}
            </p>
        </div>

        {% include 'freelance/partials/_top_freelancers.html' with top_freelancers=top_freelancers %}

        <div class="text-center mt-5" data-aos="fade-up" data-aos-delay="450">
            <a href="{% url 'freelancer_list' %}" class="btn btn-light btn-lg px-5 py-3"
               style="border-radius: 50px; font-weight: 600; box-shadow: 0 8px 24px rgba(0,0,0,0.2); transition: all 0.3s;">
                <i class="fas fa-users me-2"></i>{% trans "Browse All Freelancers" %}
            </a>
        </div>
    </div>
</section>

<!-- Top Companies Section -->
<section class="freelancing-section top-companies-section" style="padding: 5rem 0; background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); position: relative; overflow: hidden;">
    <!-- Animated Background Elements -->
    <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;">
        <div style="position: absolute; width: 280px; height: 280px; background: rgba(255,255,255,0.06); border-radius: 50%; top: -80px; left: 10%;"></div>
        <div style="position: absolute; width: 220px; height: 220px; background: rgba(255,255,255,0.06); border-radius: 50%; bottom: -60px; right: 15%;"></div>
    </div>

    <div class="container" style="position: relative; z-index: 1;">
        <!-- Section Header -->
        <div class="section-header-tabs text-center mb-5" data-aos="fade-down">
            <div class="d-inline-flex align-items-center justify-content-center mb-3"
                 style="width: 70px; height: 70px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border-radius: 50%; box-shadow: 0 8px 32px rgba(0,0,0,0.1);">
                <span class="material-icons" style="font-size: 36px; color: white;">domain</span>
            </div>
            <h2 class="section-title-tabs mb-3" style="color: white; font-size: 2.5rem; font-weight: 700;">
                {% trans "Top Companies" %}
            </h2>
            <p class="section-subtitle-tabs" style="color: rgba(255,255,255,0.95); font-size: 1.1rem; max-width: 600px; margin: 0 auto;">
                {% trans "Leading companies hiring talented professionals on our platform" %}
            </p>
        </div>

        {% include 'freelance/partials/_top_companies.html' with top_companies=top_companies %}

        <div class="text-center mt-5" data-aos="fade-up" data-aos-delay="500">
            <a href="{% url 'company_list' %}" class="btn btn-light btn-lg px-5 py-3"
               style="border-radius: 50px; font-weight: 600; box-shadow: 0 8px 24px rgba(0,0,0,0.2); transition: all 0.3s;">
                <i class="fas fa-building me-2"></i>{% trans "Browse All Companies" %}
            </a>
        </div>
    </div>
</section>
{% endblock %}
{% block js %}
<script>
    function setupSwiper(className, next, prev) {
        const swiperEl = document.querySelector(`.${className}`);
        if (swiperEl) {
            new Swiper(`.${className}`, {
                // Show 2 slides on narrow screens and 4 on desktop
                slidesPerView: 2,
                spaceBetween: 12,
                breakpoints: {
                    0:   { slidesPerView: 2, spaceBetween: 12 },
                    768: { slidesPerView: 4, spaceBetween: 25 }
                },
                navigation: {
                    nextEl: `.${next}`,
                    prevEl: `.${prev}`
                },
                loop: false,
                speed: 600,
                watchOverflow: true,
                // Enhanced options for better UX
                autoplay: {
                    delay: 5000,
                    disableOnInteraction: false,
                    pauseOnMouseEnter: true
                },
                effect: 'slide',
                touchRatio: 1,
                touchAngle: 45,
                simulateTouch: true,
                allowTouchMove: true,
                resistance: true,
                resistanceRatio: 0.85
            });
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Initialize all product swipers with new class names
        setupSwiper('newarrivals-swiper', 'newarrivals-next', 'newarrivals-prev');
        setupSwiper('featured-swiper', 'featured-next', 'featured-prev');
        setupSwiper('bestseller-swiper', 'bestseller-next', 'bestseller-prev');
        setupSwiper('onsale-swiper', 'onsale-next', 'onsale-prev');

        // Add hover effects for swiper navigation
        document.querySelectorAll('.swiper-nav-btn').forEach(btn => {
            btn.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px) scale(1)';
            });

            btn.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // Add special effects for sale section
        const saleSection = document.querySelector('.sale-section');
        if (saleSection) {
            const saleIcon = saleSection.querySelector('.sale-icon');
            if (saleIcon) {
                // Add click effect
                saleIcon.addEventListener('click', function() {
                    this.style.animation = 'none';
                    setTimeout(() => {
                        this.style.animation = 'bounce-sale 2s ease-in-out infinite';
                    }, 100);
                });
            }
        }
    });
</script>
{% endblock %}
