{% extends 'base.html' %}
{% load static %}
{% load i18n %}

{% block css %}
<!-- Home page specific styles -->
{% endblock %}

{% block content %}
<!-- Hero Slider -->
{% include 'shop/partials/hero_slider.html' %}

<!-- Category Tabs with Products -->
{% include 'shop/partials/_categories.html' with cat_name="body" categories=categories initial_category_products=initial_category_products currency=currency %}

<!-- Featured Products Section -->
{% if config.ENABLE_FEATURED_FLAG %}
<section class="product-section featured-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="50">
            <h2 class="section-title-tabs">
                <span class="material-icons">star</span>
                {% trans "Featured Products" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Hand-picked premium products just for you" %}</p>
        </div>

    <!-- Products Container (category-style) -->
    <div class="category-products-container" data-aos="fade-up" data-aos-delay="150">
            <!-- Loading / Empty states and header are handled here like _categories -->
            <div class="category-products-container aos-init aos-animate" data-aos="fade-up" data-aos-delay="150">
                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="featuredProductsSwiper" data-aos="fade-up" data-aos-delay="200">
                    <div class="swiper featured-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in featured_products %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="featured_products" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">star_border</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any featured products at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev featured-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next featured-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- New Arrivals Section -->
{% if config.ENABLE_NEW_ARRIVAL_FLAG %}
<section class="product-section newarrivals-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="100">
            <h2 class="section-title-tabs">
                <span class="material-icons">new_releases</span>
                {% trans "New Arrivals" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Fresh styles and latest trends" %}</p>
        </div>

        <!-- Products Container (category-style) -->
        <div class="category-products-container" data-aos="fade-up" data-aos-delay="200">
            <div class="category-products-container aos-init aos-animate" data-aos="fade-up" data-aos-delay="200">
                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="newarrivalsProductsSwiper" data-aos="fade-up" data-aos-delay="220">
                    <div class="swiper newarrivals-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in new_arrivals %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="new_arrivals" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">new_releases</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any new arrivals at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev newarrivals-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next newarrivals-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Best Sellers Section -->
{% if config.ENABLE_BEST_SELLER_FLAG %}
<section class="product-section bestseller-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="150">
            <h2 class="section-title-tabs">
                <span class="material-icons">trending_up</span>
                {% trans "Best Sellers" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Most popular products loved by customers" %}</p>
        </div>

        <!-- Products Container (category-style) -->
        <div class="category-products-container" data-aos="fade-up" data-aos-delay="250">

                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="bestsellerProductsSwiper" data-aos="fade-up" data-aos-delay="270">
                    <div class="swiper bestseller-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in best_sellers %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="best_sellers" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">trending_up</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any best sellers at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev bestseller-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next bestseller-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- On Sale Section -->
{% if config.ENABLE_SALE_FLAG %}
<section class="product-section sale-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="200">
            <h2 class="section-title-tabs sale-title">
                <span class="material-icons sale-icon">local_offer</span>
                {% trans "On Sale!" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Don't miss these amazing deals and discounts" %}</p>
        </div>

        <!-- Products Container (category-style) -->
        <div class="category-products-container" data-aos="fade-up" data-aos-delay="300">
                <div class="products-loading" style="display:none;">
                    <div class="loading-spinner">
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                        <div class="spinner-ring"></div>
                    </div>
                    <p class="loading-text">{% trans "Loading products..." %}</p>
                </div>

                <div class="category-products-swiper-container" id="onsaleProductsSwiper" data-aos="fade-up" data-aos-delay="320">
                    <div class="swiper onsale-swiper container">
                        <div class="swiper-wrapper">
                            {% for product in sale_products %}
                                <div class="swiper-slide">
                                    {% include "partials/_product.html" with product=product section="sale_products" %}
                                </div>
                            {% endfor %}
                        </div>
                        <div class="swiper-pagination"></div>
                    </div>
                </div>

                <div class="products-empty" style="display:none;">
                    <div class="empty-illustration">
                        <span class="material-icons empty-icon">local_offer</span>
                        <div class="empty-rings">
                            <div class="ring ring-1"></div>
                            <div class="ring ring-2"></div>
                            <div class="ring ring-3"></div>
                        </div>
                    </div>
                    <h4 class="empty-title">{% trans "No products found" %}</h4>
                    <p class="empty-message">{% trans "We couldn't find any sale products at the moment" %}</p>
                </div>
            </div>

            <!-- Navigation -->
            <div class="swiper-navigation">
                <button class="swiper-nav-btn swiper-nav-prev onsale-prev" aria-label="{% trans 'Previous' %}">
                    <span class="material-icons">chevron_left</span>
                </button>
                <button class="swiper-nav-btn swiper-nav-next onsale-next" aria-label="{% trans 'Next' %}">
                    <span class="material-icons">chevron_right</span>
                </button>
            </div>
        </div>
    </div>
</section>
{% endif %}

<!-- Home Categories -->
<section class="product-section home-categories-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="250">
            <h2 class="section-title-tabs">
                <span class="material-icons">category</span>
                {% trans "Shop Categories" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Explore our diverse product categories" %}</p>
        </div>

        <div data-aos="fade-up" data-aos-delay="350">
            {% include 'shop/partials/_home_categories.html' %}
        </div>
    </div>
</section>

<!-- Freelance Categories -->
<section class="product-section freelance-categories-section">
    <div class="container">
        <!-- Section Header -->
        <div class="section-header-tabs" data-aos="fade-up" data-aos-delay="300">
            <h2 class="section-title-tabs">
                <span class="material-icons">work</span>
                {% trans "Freelance Services" %}
            </h2>
            <p class="section-subtitle-tabs">{% trans "Professional services by skilled freelancers" %}</p>
        </div>

        <div data-aos="fade-up" data-aos-delay="400">
            {% include 'freelance/partials/_home_categories.html' %}
        </div>
    </div>
</section>
{% endblock %}
{% block js %}
<script>
    function setupSwiper(className, next, prev) {
        const swiperEl = document.querySelector(`.${className}`);
        if (swiperEl) {
            new Swiper(`.${className}`, {
                // Show 2 slides on narrow screens and 4 on desktop
                slidesPerView: 2,
                spaceBetween: 12,
                breakpoints: {
                    0:   { slidesPerView: 2, spaceBetween: 12 },
                    768: { slidesPerView: 4, spaceBetween: 25 }
                },
                navigation: {
                    nextEl: `.${next}`,
                    prevEl: `.${prev}`
                },
                loop: false,
                speed: 600,
                watchOverflow: true,
                // Enhanced options for better UX
                autoplay: {
                    delay: 5000,
                    disableOnInteraction: false,
                    pauseOnMouseEnter: true
                },
                effect: 'slide',
                touchRatio: 1,
                touchAngle: 45,
                simulateTouch: true,
                allowTouchMove: true,
                resistance: true,
                resistanceRatio: 0.85
            });
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Initialize all product swipers with new class names
        setupSwiper('newarrivals-swiper', 'newarrivals-next', 'newarrivals-prev');
        setupSwiper('featured-swiper', 'featured-next', 'featured-prev');
        setupSwiper('bestseller-swiper', 'bestseller-next', 'bestseller-prev');
        setupSwiper('onsale-swiper', 'onsale-next', 'onsale-prev');

        // Add hover effects for swiper navigation
        document.querySelectorAll('.swiper-nav-btn').forEach(btn => {
            btn.addEventListener('mouseenter', function() {
                this.style.transform = 'translateY(-2px) scale(1)';
            });

            btn.addEventListener('mouseleave', function() {
                this.style.transform = 'translateY(0) scale(1)';
            });
        });

        // Add special effects for sale section
        const saleSection = document.querySelector('.sale-section');
        if (saleSection) {
            const saleIcon = saleSection.querySelector('.sale-icon');
            if (saleIcon) {
                // Add click effect
                saleIcon.addEventListener('click', function() {
                    this.style.animation = 'none';
                    setTimeout(() => {
                        this.style.animation = 'bounce-sale 2s ease-in-out infinite';
                    }, 100);
                });
            }
        }
    });
</script>
{% endblock %}
